THREE.OrbitControls=function(t,e){this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.noRotate=!1,this.rotateSpeed=1,this.noTilt=!1,this.tiltSpeed=1,this.noPan=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var n=this,o=new THREE.Vector2,a=new THREE.Vector2,i=new THREE.Vector2,s=(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2,new THREE.Vector2),c=new THREE.Vector2,r=new THREE.Vector2,h=new THREE.Vector2,l=new THREE.Vector2,u=new THREE.Vector2,d=0,E=0,m=1,p=new THREE.Vector3,f=new THREE.Vector3,T={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},b=T.NONE,R={type:"change"};function v(){return 2*Math.PI/60/60*n.autoRotateSpeed}function O(){return Math.pow(.95,n.zoomSpeed)}function g(t){if(!1!==n.enabled)if(t.preventDefault(),b===T.ROTATE){if(!0===n.noRotate&&!0===n.noTilt)return;!1===n.noRotate&&!1===n.noTilt?(a.set(t.clientX,t.clientY),i.subVectors(a,o),n.rotateLeft(2*Math.PI*i.x/n.domElement.width*n.rotateSpeed),n.rotateUp(2*Math.PI*i.y/n.domElement.height*n.rotateSpeed)):!1===n.noRotate?(a.set(t.clientX,t.clientY),i.subVectors(a,o),n.rotateLeft(2*Math.PI*i.x/n.domElement.width*n.rotateSpeed)):(a.set(t.clientX,t.clientY),i.subVectors(a,o),n.rotateUp(2*Math.PI*i.y/n.domElement.height*n.rotateSpeed)),o.copy(a)}else if(b===T.DOLLY){if(!0===n.noZoom)return;l.set(t.clientX,t.clientY),u.subVectors(l,h),u.y>0?n.dollyIn():n.dollyOut(),h.copy(l)}else if(b===T.PAN){if(!0===n.noPan)return;c.set(t.clientX,t.clientY),r.subVectors(c,s),n.pan(r),s.copy(c)}}function y(){!1!==n.enabled&&(document.removeEventListener("mousemove",g,!1),document.removeEventListener("mouseup",y,!1),b=T.NONE)}function w(t){if(!1!==n.enabled&&!0!==n.noZoom){var e=0;t.wheelDelta?e=t.wheelDelta:t.detail&&(e=-t.detail),e>0?n.dollyOut():n.dollyIn()}}this.rotateLeft=function(t){void 0===t&&(t=v()),E-=t},this.rotateUp=function(t){void 0===t&&(t=v()),d-=t},this.panLeft=function(t){var e=new THREE.Vector3,n=this.object.matrix.elements;e.set(n[0],n[1],n[2]),e.multiplyScalar(-t),p.add(e)},this.panUp=function(t){var e=new THREE.Vector3,n=this.object.matrix.elements;e.set(n[4],n[5],n[6]),e.multiplyScalar(t),p.add(e)},this.pan=function(t){if(void 0!==n.object.fov){var e=n.object.position.clone().sub(n.target).length();e*=Math.tan(n.object.fov/2*Math.PI/180),n.panLeft(2*t.x*e/n.domElement.height),n.panUp(2*t.y*e/n.domElement.height)}else void 0!==n.object.top?(n.panLeft(t.x*(n.object.right-n.object.left)/n.domElement.width),n.panUp(t.y*(n.object.top-n.object.bottom)/n.domElement.height)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=O()),m/=t},this.dollyOut=function(t){void 0===t&&(t=O()),m*=t},this.update=function(){var t=this.object.position,e=t.clone().sub(this.target),n=Math.atan2(e.x,e.z),o=Math.atan2(Math.sqrt(e.x*e.x+e.z*e.z),e.y);this.autoRotate&&this.rotateLeft(v()),n+=E,o+=d,o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o)),o=Math.max(1e-6,Math.min(Math.PI-1e-6,o));var a=e.length()*m;a=Math.max(this.minDistance,Math.min(this.maxDistance,a)),this.target.add(p),e.x=a*Math.sin(o)*Math.sin(n),e.y=a*Math.cos(o),e.z=a*Math.sin(o)*Math.cos(n),t.copy(this.target).add(e),this.object.lookAt(this.target),E=0,d=0,m=1,p.set(0,0,0),f.distanceTo(this.object.position)>0&&(this.dispatchEvent(R),f.copy(this.object.position))},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",function(t){if(!1!==n.enabled){if(t.preventDefault(),0===t.button){if(!0===n.noTilt&&!0===n.noRotate)return;b=T.ROTATE,o.set(t.clientX,t.clientY)}else if(1===t.button){if(!0===n.noZoom)return;b=T.DOLLY,h.set(t.clientX,t.clientY)}else if(2===t.button){if(!0===n.noPan)return;b=T.PAN,s.set(t.clientX,t.clientY)}else if(6===t.button){if(!0===n.noTilt)return;b=T.TILT,o.set(t.clientX,t.clientY)}document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",y,!1)}},!1),this.domElement.addEventListener("mousewheel",w,!1),this.domElement.addEventListener("DOMMouseScroll",w,!1),this.domElement.addEventListener("keydown",function(t){if(!1!==n.enabled&&!0!==n.noKeys&&!0!==n.noPan)switch(t.keyCode){case n.keys.UP:n.pan(new THREE.Vector2(0,1));break;case n.keys.BOTTOM:n.pan(new THREE.Vector2(0,-1));break;case n.keys.LEFT:n.pan(new THREE.Vector2(1,0));break;case n.keys.RIGHT:n.pan(new THREE.Vector2(-1,0))}},!1),this.domElement.addEventListener("touchstart",function(t){if(!1!==n.enabled)switch(t.touches.length){case 1:if(!0===n.noRotate)return;b=T.TOUCH_ROTATE,o.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===n.noZoom)return;b=T.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,a=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+a*a);h.set(0,i);break;case 3:if(!0===n.noPan)return;b=T.TOUCH_PAN,s.set(t.touches[0].pageX,t.touches[0].pageY);break;default:b=T.NONE}},!1),this.domElement.addEventListener("touchend",function(){!1!==n.enabled&&(b=T.NONE)},!1),this.domElement.addEventListener("touchmove",function(t){if(!1!==n.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!0===n.noRotate)return;if(b!==T.TOUCH_ROTATE)return;a.set(t.touches[0].pageX,t.touches[0].pageY),i.subVectors(a,o),n.rotateLeft(2*Math.PI*i.x/n.domElement.width*n.rotateSpeed),o.copy(a);break;case 2:if(!0===n.noZoom)return;if(b!==T.TOUCH_DOLLY)return;var e=t.touches[0].pageX-t.touches[1].pageX,d=t.touches[0].pageY-t.touches[1].pageY,E=Math.sqrt(e*e+d*d);l.set(0,E),u.subVectors(l,h),u.y>0?n.dollyOut():n.dollyIn(),h.copy(l);break;case 3:if(!0===n.noPan)return;if(b!==T.TOUCH_PAN)return;c.set(t.touches[0].pageX,t.touches[0].pageY),r.subVectors(c,s),n.pan(r),s.copy(c);break;default:b=T.NONE}},!1)},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);