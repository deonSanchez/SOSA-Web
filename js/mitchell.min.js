var login_content=$("div#login_content"),color_selection=-1;function objLength(t){var e=0;for(var n in t)t.hasOwnProperty(n)&&e++;return e}function checkLogin(){$.ajax({type:"POST",data:"request=checklogin",url:"api/index.php",async:!0,success:function(t){1==t&&(login_content.html("You are already signed in!"),$("button#signin").hide(),$("a#sign-in-nav").hide(),$("a#log-out-nav").show())},error:function(){alert("An error has occured while verifying logged-in status!")}})}function loadStimulusSets(t){$.ajax({type:"POST",data:"request=loadstimsets",url:"api/index.php",async:!0,success:function(e){var n=JSON.parse(e);console.log(n);for(var i=objLength(n),a="",s=0;s<i;s++)a=a+"<option>"+n[s].title+"</option>";$("select#stimulus-set").html(a),"function"==typeof t&&t()},error:function(){alert("Error with create stimulus!")}})}function loadCurrentStimulusSet(){var t=$("#stimulus-set :selected").text();$.ajax({type:"POST",data:"request=loadstimset&set_title="+t,url:"api/index.php",async:!0,success:function(t){if("null"!=t){for(var e=JSON.parse(t),n="",i=objLength(e)-1;i>-1;i--)n=n+'<option id="'+e[i].stimulus_id+'">'+e[i].label+"</option>";$("select#individual_stimulus").html(n)}else $("select#individual_stimulus").html("")},error:function(){alert("Error with create stimulus!")}})}$(function(){checkLogin(),loadStimulusSets(loadCurrentStimulusSet)}),$("button#signin").on("click",function(t){var e=$("input#username").val(),n=$("input#password").val();login_content.html('<img style="display: block;margin-left: auto; margin-right: auto;" src="./img/gear.gif" />'),$.ajax({type:"POST",data:"request=login&username="+e+"&password="+n,url:"api/index.php",async:!0,success:function(t){1==t?(login_content.html("You are already signed in!"),$("button#signin").hide(),$("a#sign-in-nav").hide(),$("a#log-out-nav").show(),$("div#sign-in").modal("hide")):(alert("Failed to login! Try again?"),login_content.html('<input id="username" type="text" class="form-control mb-3" placeholder="Username"> <input id="password" type="text" class="form-control" placeholder="Password">'))},error:function(){alert("Error with logout!")}})}),$("a#log-out-nav").on("click",function(){$.ajax({type:"POST",data:"request=logout",url:"api/index.php",async:!0,success:function(t){window.location="index.php"},error:function(){var err=eval("("+xhr.responseText+")");alert(err.Message)}})}),$("button#register-submit").on("click",function(){var t=$("input#regusername").val(),e=$("input#regpassword").val(),n=$("input#regpasswordconf").val();$.ajax({type:"POST",data:"request=register&username="+t+"&password="+e+"&passwordconf="+n,url:"api/index.php",async:!0,success:function(t){1==t?(alert("Success!"),$("div#sign-in").modal("hide")):login_content.html(t)},error:function(){alert("Error with logout!")}})}),$("button#create_stimulus").on("click",function(){var t=$("input#stimulus_name").val(),e=$("input#RvalueStim").val(),n=$("input#GvalueStim").val(),i=$("input#BvalueStim").val(),a=$("#stimulus-set :selected").text();$.ajax({type:"POST",data:"request=createstimulus&label="+t+"&peg_r="+e+"&peg_g="+n+"&peg_b="+i+"&label_r="+e+"&label_g="+n+"&label_b="+i+"&set_title="+a,url:"api/index.php",async:!0,success:function(e){1==e?(loadCurrentStimulusSet(),$("#invididual_stimulus").val(t)):alert("Error adding stimulus!")},error:function(){alert("Error with create stimulus!")}})}),$("button#load").on("click",function(){var t=$("select#individual_stimulus :selected").attr("id");$.ajax({type:"POST",data:"request=loadstimulus&stimulus_id="+t,url:"api/index.php",async:!0,success:function(e){var n=JSON.parse(e),i=n[0].label,a=n[0].peg_r,s=n[0].peg_g,u=n[0].peg_b;$("input#stimulus_name").val(i),$("input#RvalueStim").val(a),$("span#sR").val(a),$("input#GvalueStim").val(s),$("span#sG").val(s),$("input#BvalueStim").val(s),$("span#sB").val(u),$("input#selected_stimulus").val(t)},error:function(){alert("Error with create stimulus!")}})}),$("button#save").on("click",function(){$("#stimulus-set :selected").text();var t=$("input#stimulus_name").val(),e=$("input#RvalueStim").val(),n=$("input#GvalueStim").val(),i=$("input#BvalueStim").val(),a=$("input#selected_stimulus").val();$.ajax({type:"POST",data:"request=updatestimulus&set_name="+t+"&peg_r="+e+"&peg_g="+n+"&peg_b="+i+"&stimulus_id="+a,url:"api/index.php",async:!0,success:function(t){loadCurrentStimulusSet()},error:function(){alert("Error with create stimulus!")}})}),$("button#remove_stim").on("click",function(){var t=$("select#individual_stimulus :selected").attr("id");$.ajax({type:"POST",data:"request=deletestimulus&stimulus_id="+t,url:"api/index.php",async:!0,success:function(t){loadCurrentStimulusSet()},error:function(){alert("Error with create stimulus!")}})}),$("button#add").on("click",function(){var t=$("input#set_name").val();$.ajax({type:"POST",data:"request=createset&set_name="+t,url:"api/index.php",async:!0,success:function(e){1==e?$("select#stimulus-set").prepend("<option>"+t+"</option>"):alert("Cannot create new stimulus set with name of another set OR with non-alphanumeric name!")},error:function(){alert("Error with create stimulus!")}})}),$("button#remove").on("click",function(){var t=$("#stimulus-set :selected").text();$.ajax({type:"POST",data:"request=deleteset&set_name="+t,url:"api/index.php",async:!0,success:function(t){loadStimulusSets(loadCurrentStimulusSet)},error:function(){alert("Error with create stimulus!")}})}),$("#stimulus-set").on("change",function(){loadCurrentStimulusSet()});